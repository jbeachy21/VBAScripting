Sub Ticker()        Dim LastRow As Long    Dim Ticker_Row As Integer    Dim Currentticker As String    Dim Nextticker As String    Dim Ticker As String        Dim ws As Worksheet    Dim WS_count As Integer    WS_count = 1              For Each ws In Worksheets        Cells(1, 9).Value = "Ticker"        Worksheets(WS_count).Activate        WS_count = WS_count + 1        LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row        Ticker_Row = 2        For i = 2 To LastRow                Currentticker = Cells(i, 1).Value            Nextticker = Cells(i + 1, 1).Value         'Check for unique 'ticker' each time         If Nextticker <> Currentticker Then         'add ticker to data structure            Range("I" & Ticker_Row).Value = Currentticker            Ticker_Row = Ticker_Row + 1        End If                       Next i    Next wsEnd SubSub yearlychange()     Dim LastRow As Long     Dim ws As Worksheet     Dim WS_count As Integer     WS_count = 1     Dim opened As Double     Dim closed As Double     Dim YearlyChanged As Double            opened = 0    closed = 0        For Each ws In Worksheets        Cells(1, 10).Value = "Yearly Change"        LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row        Worksheets(WS_count).Activate        WS_count = WS_count + 1        For i = 2 To LastRow             YearlyChanged = 0             opened = Cells(i, 3).Value             closed = Cells(i, 6).Value                        YearlyChanged = opened - closed            Cells(i, 10).Value = YearlyChanged                        If YearlyChanged <= 0 Then                Cells(i, 10).Interior.ColorIndex = 3            Else                Cells(i, 10).Interior.ColorIndex = 4                       End If        Next i            Next ws    End SubSub percentchange()     Dim LastRow As Long     Dim ws As Worksheet     Dim WS_count As Integer     WS_count = 1     Dim yearlychange As Double     Dim closed As Double     Dim PercentChanged As Double                 yearlychange = 0    closed = 0        For Each ws In Worksheets        Cells(1, 11).Value = "Percent Change"        LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row        Worksheets(WS_count).Activate        WS_count = WS_count + 1        For i = 2 To LastRow             PercentChanged = 0             yearlychange = Cells(i, 10).Value             closed = Cells(i, 6).Value            If closed = 0 Then                Cells(i, 11).Value = "NaN"            Else                PercentChanged = yearlychange / closed                PercentChanged = PercentChanged * 100                Cells(i, 11).Value = PercentChanged            End If                                            Next i            Next ws    End SubSub stockvolume()     Dim LastRow As Long     Dim ws As Worksheet     Dim WS_count As Integer     WS_count = 1     Dim volume As LongLong              For Each ws In Worksheets        volume = 0        Cells(1, 12).Value = "Total Stock Volume"        LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row        Worksheets(WS_count).Activate        WS_count = WS_count + 1        For i = 2 To LastRow                         If i = 2 Then                volume = Cells(i, 7).Value                Cells(i, 12).Value = volume                                            Else                                                     'if ticker is  the same then business as usual            If Cells(i - 1, 1).Value = Cells(i, 1).Value Then                                volume = Cells(i - 1, 12).Value + Cells(i, 7).Value                                Cells(i, 12).Value = volume                         End If                    End If        Next i            Next ws    End Sub 